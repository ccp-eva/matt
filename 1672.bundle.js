"use strict";(self.webpackChunkmatt=self.webpackChunkmatt||[]).push([[1672],{1672:(t,e,a)=>{a.r(e),a.d(e,{default:()=>u});var o=a(6358),n=a(2354),s=a(6486),i=a.n(s),d=a(9965),r=a(7103),c=a(8503),l=a(1489);o.p8.registerPlugin(n._);const u=async()=>{(0,l.TH)(i().kebabCase(data.currentSlide),i().kebabCase(data.previousSlide),[0,0]),data.procedure.sTask={duration:0,knownAnimals:[],unknownAnimals:[],human:"",chicken:void 0,pig:void 0,dog:void 0,sheep:void 0,goldfish:void 0,cow:void 0,rabbit:void 0,cat:void 0,assignedAnimals:0,comprehension:{completed:!1,order:i().shuffle(["inner","middle","outer"]),inner:!1,middle:!1,outer:!1}};const t=document.getElementById("link-st-next"),e=document.getElementById("player"),a=document.getElementById("st-inner"),s=document.getElementById("st-middle"),u=document.getElementById("st-outer");document.getElementById("link-st-human"),document.getElementById("link-st-chicken"),document.getElementById("link-st-pig"),document.getElementById("link-st-dog"),document.getElementById("link-st-sheep"),document.getElementById("link-st-goldfish"),document.getElementById("link-st-cow"),document.getElementById("link-st-rabbit"),document.getElementById("link-st-cat"),o.p8.to([a,s,u],{opacity:.5}),[a,s,u].forEach((t=>{t.style.cursor="pointer",t.addEventListener("mouseenter",(()=>{o.p8.timeline().to(t,{autoAlpha:1})})),t.addEventListener("mouseleave",(()=>{o.p8.timeline().to(t,{autoAlpha:.5})}))}));let p=[],m=[];["chicken","pig","dog","sheep","goldfish","cow","rabbit","cat"].forEach((t=>{const e=i().camelCase(`s-${t}`);if(!data.procedure[e])return console.warn(`${t} not found in data.procedure, treating it as unknown.`),void m.push(t);"yes"===data.procedure[e].response.split("-").at(-1)&&p.push(t),"no"===data.procedure[e].response.split("-").at(-1)&&m.push(t)})),data.procedure.sTask.knownAnimals=p,data.procedure.sTask.unknownAnimals=m,p=[...p,"human"];const h=p.map((t=>document.getElementById(`link-st-${t}`))),g=m.map((t=>document.getElementById(`link-st-${t}`)));o.p8.set(g,{autoAlpha:0}),o.p8.set(e,{autoAlpha:0}),o.p8.set(t,{autoAlpha:0}),o.p8.timeline().to(e,{autoAlpha:1,delay:.5,onStart:()=>{e.src=`./cultures/${data.culture}/video/s-task.webm`}}).to(e,{autoAlpha:0,delay:14}),await(0,c._v)(14e3),(0,d.hY)(`./cultures/${data.culture}/audio/s-task-cut.mp3`,"link-st-headphones");const k=a.getBBox().width/2,y=s.getBBox().width/2,B=u.getBBox().width/2,w=a.getBBox().x+k,E=a.getBBox().y+k;s.getBBox().x,s.getBBox().y,u.getBBox().x,u.getBBox().y,n._.create(h,{onPress:function(){let t=this.target.id.slice(8);(0,d.hY)(`./cultures/${data.culture}/audio/st-${t}.mp3`)},onDrag:function(){const t=this.target,e=t.getBBox(),n=t.getBBox().height/2,i=t.getBBox().width/2;let d=e.x+i+this.x,r=e.y+n+this.y;const c=Math.sqrt(Math.pow(d-w,2)+Math.pow(r-E,2));1.2*c<=k+i&&(o.p8.to(a,{opacity:1}),o.p8.to([s,u],{opacity:.5})),1.2*c<=y+i&&1.2*c>k+i&&(o.p8.to(s,{opacity:1}),o.p8.to([a,u],{opacity:.5})),1.2*c<=B+i&&1.2*c>y+i&&(o.p8.to(u,{opacity:1}),o.p8.to([a,s],{opacity:.5}),o.p8.to(this.target,{scale:.5,transformOrigin:"50% 50%"})),1.2*c>B+i&&(o.p8.to(this.target,{scale:1,transformOrigin:"50% 50%"}),o.p8.to([a,s,u],{opacity:.5}))},onDragEnd:function(){const t=this.target,e=t.id;console.log(e);const n=e.slice(8),i=t.getBBox(),d=t.getBBox().height/2,r=t.getBBox().width/2;let c=i.x+r+this.x,l=i.y+d+this.y;const p=Math.sqrt(Math.pow(c-w,2)+Math.pow(l-E,2));1.2*p<=k+r&&(data.procedure.sTask[n]="inner",data.procedure.sTask.assignedAnimals++,o.p8.to(a,{opacity:.5,duration:.25})),1.2*p<=y+r&&1.2*p>k+r&&(data.procedure.sTask[n]="middle",data.procedure.sTask.assignedAnimals++,o.p8.to(s,{opacity:.5,duration:.25})),1.2*p<=B+r&&1.2*p>y+r&&(data.procedure.sTask[n]="outer",data.procedure.sTask.assignedAnimals++,o.p8.to(u,{opacity:.5,duration:.25})),1.2*p>B+r&&o.p8.to(t,{x:0,y:0})}});const x=()=>{let t=[];return p.forEach((e=>{data.procedure.sTask[e]||t.push(!1)})),t};for(;data.procedure.sTask.assignedAnimals<Math.ceil(p.length/2);)await(0,c._v)(500);console.log("Comprehension check..."),o.p8.timeline().to(p.map((t=>`#link-st-${t}`)),{autoAlpha:0});for(const t of data.procedure.sTask.comprehension.order){(0,d.hY)(`./cultures/${data.culture}/audio/s-comp-check-${t}.mp3`,"link-st-headphones"),await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check.mp3`),await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check-${t}.mp3`),await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check-expl.mp3`);const e=await(0,r.c)(["st-inner","st-middle","st-outer"]),a=["ok","alright","okThanks"],o=a[Math.floor(Math.random()*a.length)];await(0,d.bA)(`./cultures/${data.culture}/audio/neutral-resp-${o}.mp3`),e.id.slice(3)===t&&(data.procedure.sTask.comprehension[t]=!0)}for(data.procedure.sTask.comprehension.completed=!0,o.p8.timeline().to(p.map((t=>`#link-st-${t}`)),{autoAlpha:1});x().length>0;)await(0,c._v)(1e3);o.p8.timeline().to(t,{autoAlpha:1}).to(t,{filter:"drop-shadow(0px 0px 14px #a90707)",delay:1,repeat:-1,yoyo:!0,reversed:!0}),await(0,r.c)(t.id),(0,d.sT)()}},7103:(t,e,a)=>{a.d(e,{c:()=>o});const o=t=>new Promise((e=>{const a=t=>{const a=t.target;return e(a)};"string"==typeof t&&document.getElementById(t).addEventListener("click",a,{once:!0}),Array.isArray(t)&&t.forEach((t=>{document.getElementById(t).addEventListener("click",a,{once:!0})})),void 0===t&&document.getElementById("wrapper").addEventListener("click",a,{once:!0})}))}}]);