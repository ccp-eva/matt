"use strict";(self.webpackChunkmatt=self.webpackChunkmatt||[]).push([[8312],{8312:(t,e,a)=>{a.r(e),a.d(e,{default:()=>c});var n=a(6358),o=a(5919),i=a(5212),d=a.n(i),s=a(9965),l=a(7103),r=a(8503),u=a(1489);const c=async({currentSlide:t,previousSlide:e})=>{const a={transition:"",neutral:"",text:"",audio:""};a.transition=`./cultures/${data.culture}/video/st-finish-meaning.${data.meta.videoExtension}`,data.pindaNeutralBlob||(a.neutral=`./cultures/${data.culture}/video/pinda-neutral-listening.${data.meta.videoExtension}`),data.textIntroBlob||"text"!==data.input||(a.text=`./cultures/${data.culture}/video/s-ex-next-red-textInput.${data.meta.videoExtension}`),data.audioIntroBlob||"audio"!==data.input||(a.audio=`./cultures/${data.culture}/video/prompt-audioInput-start-speaking-buttons.${data.meta.videoExtension}`),"userchoice-audio"!==data.input&&"userchoice-text"!==data.input||(data.textIntroBlob||(a.text=`./cultures/${data.culture}/video/s-ex-next-red-textInput.${data.meta.videoExtension}`),data.audioIntroBlob||(a.audio=`./cultures/${data.culture}/video/prompt-audioInput-start-speaking-buttons.${data.meta.videoExtension}`));const i=document.getElementById("s-blocking-state");i.removeAttribute("visibility");for(const[t,e]of Object.entries(a))if(e){const n=await fetch(e),o=await n.blob();a[t]=URL.createObjectURL(o)}data.pindaNeutralBlob=data.pindaNeutralBlob||a.neutral,data.textIntroBlob=data.textIntroBlob||a.text,data.audioIntroBlob=data.audioIntroBlob||a.audio,a.neutral=a.neutral||data.pindaNeutralBlob,a.text=a.text||data.textIntroBlob,a.audio=a.audio||data.audioIntroBlob,i.setAttribute("visibility","hidden"),console.log(a);{const t=document.getElementById("sm-written-response"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");[...t.attributes].map((({name:t,value:a})=>e.setAttribute(t,a))),e.removeAttribute("fill"),t.replaceWith(e),e.innerHTML='\n\t<div id="wrapper-smeaning" style="display: none;">\n\t\t<div id="toggle-smeaning" style="width: 9em; margin: 0 auto; margin-bottom: 10px">\n\t\t\t\t<input id="chck-smeaning" type="checkbox" />\n\t\t\t<label for="chck-smeaning" class="check-trail"><span class="check-handler"></span> </label>\n\t\t</div>\n\n\t\t<div>\n\t\t\t<textarea\n\t\t\t   rows="5"\n\t\t\t\tdisabled\n\t\t\t\tid="text-response-smeaning"\n\t\t\t\tmaxlength="2000"\n\t\t\t\tstyle="display: block; pointer-events: auto;"\n\t\t\t></textarea>\n\t\t\t<div id="voice-response-smeaning" style="display: flex;">\n\t\t\t\t<button type="button" class="button" disabled id="voice-response-start-smeaning"><span>ðŸŽ¤&nbsp;Start</span></button> <button type="button" class="button" disabled id="voice-response-stop-smeaning"><span>ðŸ›‘&nbsp;Stop</span></button>\n\t\t\t</div>\n\t\t</div>\n\t</div>'}const c=document.getElementById("link-sm-headphones"),p=document.getElementById("audio"),v=document.getElementById("pinda"),y=document.getElementById("pinda-neutral"),m=document.getElementById("link-sm-next"),b=document.getElementById("wrapper-smeaning"),x=document.getElementById("text-response-smeaning"),g=document.getElementById("voice-response-smeaning"),h=document.getElementById("voice-response-start-smeaning"),E=document.getElementById("voice-response-stop-smeaning"),k=document.getElementById("toggle-smeaning"),I=document.querySelector(".check-trail"),w=document.getElementById("chck-smeaning");m.style.pointerEvents="none",I.style.pointerEvents="none",n.ZP.set([m,I],{autoAlpha:.25}),data.procedure[data.currentSlide]={duration:0,input:data.input,textInput:"",isText:!1,isVoice:!1,voiceExplanation:!1,textExplanation:!1},"text"===data.input&&(k.style.visibility="hidden",g.style.display="none"),"audio"===data.input&&(w.click(),k.style.visibility="hidden",x.style.display="none",g.style.display="flex"),"userchoice-audio"===data.input&&(w.click(),x.style.display="none",g.style.display="flex"),"userchoice-text"===data.input&&(x.style.display="block",g.style.display="none"),b.style.display="block",data.meta.isSafari&&data.meta.isMobileDevice&&(b.style.display="inline-block"),data.procedure[data.currentSlide].voiceExplanation=w.checked,data.procedure[data.currentSlide].textExplanation=!w.checked;let B=!0;for(v.addEventListener("play",(()=>{B=!0})),v.addEventListener("ended",(()=>{B=!1})),v.src=a.transition,await(0,r._v)(5e3),(0,u.TH)(t,e,[3,2]);B;)await(0,r._v)(100);if(w.checked){v.src=a.audio;const t={voiceResponseStart:{"de-urban":8,"pe-rural":9.5,"idj-urban":13.5,"nam-rural":8.5},voiceResponseStop:{"de-urban":1.5,"pe-rural":1.5,"idj-urban":2.5,"nam-rural":2}};await n.ZP.timeline().to(h,{filter:"drop-shadow(0px 0px 18px #000)",delay:t.voiceResponseStart[data.culture],repeat:3,yoyo:!0,reversed:!0}).to(E,{filter:"drop-shadow(0px 0px 18px #000)",delay:t.voiceResponseStop[data.culture],repeat:3,yoyo:!0,reversed:!0})}for(w.checked||(v.src=a.text,await(0,r._v)(500));B;)await(0,r._v)(100);y.src=a.neutral,n.ZP.timeline().to(v,{autoAlpha:0}).to(y,{autoAlpha:1},"<"),n.ZP.to(I,{autoAlpha:1}),I.style.pointerEvents="auto",x.disabled=!1,h.disabled=!1,(0,s.hY)(`./cultures/${data.culture}/audio/st-meaning.mp3`,c.id),p.addEventListener("play",(()=>{I.style.pointerEvents="none",n.ZP.set(I,{autoAlpha:.25})})),p.addEventListener("ended",(()=>{I.style.pointerEvents="visible",n.ZP.set(I,{autoAlpha:1})})),"userchoice-audio"!==data.input&&"userchoice-text"!==data.input||w.addEventListener("change",(async()=>{const t=w.checked,e=!w.checked;if(t&&(x.style.display="none",g.style.display="flex"),e&&(x.style.display="block",g.style.display="none"),t&&!data.procedure[data.currentSlide].voiceExplanation){data.procedure[data.currentSlide].voiceExplanation=!0,h.disabled=!0,I.style.pointerEvents="none",c.style.pointerEvents="none",n.ZP.set([m,I],{autoAlpha:.25}),n.ZP.to(y,{autoAlpha:0}),v.src=a.audio;const t={voiceResponseStart:{"de-urban":8,"pe-rural":9.5,"idj-urban":13.5},voiceResponseStop:{"de-urban":1.5,"pe-rural":1.5,"idj-urban":2.5}};for(await n.ZP.timeline().to(h,{filter:"drop-shadow(0px 0px 18px #000)",delay:t.voiceResponseStart[data.culture],repeat:3,yoyo:!0,reversed:!0}).to(E,{filter:"drop-shadow(0px 0px 18px #000)",delay:t.voiceResponseStop[data.culture],repeat:3,yoyo:!0,reversed:!0});B;)await(0,r._v)(100);h.disabled=!1,n.ZP.to(I,{autoAlpha:1}),I.style.pointerEvents="auto",c.style.pointerEvents="auto",n.ZP.timeline().to(v,{autoAlpha:0}).to(y,{autoAlpha:1},"<")}if(e&&!data.procedure[data.currentSlide].textExplanation){for(data.procedure[data.currentSlide].textExplanation=!0,x.disabled=!0,I.style.pointerEvents="none",c.style.pointerEvents="none",n.ZP.set(I,{autoAlpha:.25}),n.ZP.to(y,{autoAlpha:0}),v.src=a.text,await(0,r._v)(500);B;)await(0,r._v)(100);x.disabled=!1,n.ZP.to(I,{autoAlpha:1}),I.style.pointerEvents="auto",c.style.pointerEvents="auto",n.ZP.timeline().to(v,{autoAlpha:0}).to(y,{autoAlpha:1},"<")}})),x.addEventListener("input",(()=>{x.value.length>=o.Z.globals.minimumTextInputLength?(data.procedure[data.currentSlide].isText=!0,data.procedure[data.currentSlide].isVoice=!1,n.ZP.set(m,{autoAlpha:1}),n.ZP.set(I,{autoAlpha:.25}),m.style.pointerEvents="visible",I.style.pointerEvents="none"):(n.ZP.set(I,{autoAlpha:1}),n.ZP.set(m,{autoAlpha:.25}),m.style.pointerEvents="none",I.style.pointerEvents="visible")})),h.addEventListener("click",(async()=>{data.procedure[data.currentSlide].isText=!1,data.procedure[data.currentSlide].isVoice=!0;let t=await navigator.mediaDevices.getUserMedia({audio:!0}),e=new(d().RecordRTCPromisesHandler)(t,{type:"audio"});e.startRecording(),h.disabled=!0,E.disabled=!1,I.style.pointerEvents="none",n.ZP.set(I,{autoAlpha:.25}),E.addEventListener("click",(async()=>{await e.stopRecording();let t=await e.getBlob();(0,r.vw)(t,(0,r.Dz)("matt",`${data.currentSlide}`,"ogg")),d().invokeSaveAsDialog(t,(0,r.Dz)("matt",`${data.currentSlide}`,"ogg")),m.style.pointerEvents="auto",n.ZP.timeline().to(m,{autoAlpha:1}),h.disabled=!1,E.disabled=!0,I.style.pointerEvents="auto",n.ZP.set(I,{autoAlpha:1})}))}));const S=await(0,l.c)(m.id);console.log(S.id),data.procedure[data.currentSlide].textInput=x.value,console.log(data.procedure[data.currentSlide].textInput),(0,r.xF)()}},7103:(t,e,a)=>{a.d(e,{c:()=>n});const n=t=>new Promise((e=>{const a=t=>{const a=t.target;return e(a)};"string"==typeof t&&document.getElementById(t).addEventListener("click",a,{once:!0}),Array.isArray(t)&&t.forEach((t=>{document.getElementById(t).addEventListener("click",a,{once:!0})})),void 0===t&&document.getElementById("wrapper").addEventListener("click",a,{once:!0})}))}}]);