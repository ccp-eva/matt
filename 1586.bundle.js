"use strict";(self.webpackChunkmatt=self.webpackChunkmatt||[]).push([[1586],{1586:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l});var a=o(6358),r=o(2354),s=o(6486),n=o.n(s),d=o(9965),i=o(7103),c=o(8503),u=o(1489);a.p8.registerPlugin(r._);const l=async({currentSlide:e,previousSlide:t})=>{(0,u.TH)(e,t,[0,0]),data.procedure.sTaskIdj={duration:0,knownAnimals:[],unknownAnimals:[],humanidj:{circle:void 0,coords:{x:0,y:0}},chicken:{circle:void 0,coords:{x:0,y:0}},catfish:{circle:void 0,coords:{x:0,y:0}},dog:{circle:void 0,coords:{x:0,y:0}},goat:{circle:void 0,coords:{x:0,y:0}},goldfish:{circle:void 0,coords:{x:0,y:0}},cow:{circle:void 0,coords:{x:0,y:0}},parrot:{circle:void 0,coords:{x:0,y:0}},cat:{circle:void 0,coords:{x:0,y:0}},knownAnimalOrder:[],comprehension:{completed:!1,order:n().shuffle(["inner","middle","outer"]),inner:!1,middle:!1,outer:!1}};const o=document.getElementById("link-stidj-next"),s=document.getElementById("pinda"),l=document.getElementById("audio"),p=document.getElementById("link-stidj-headphones"),m=document.getElementById("stidj-circle"),h=document.getElementById("st-inner_00000137851898872019742480000005807525445235371402_"),v=document.getElementById("st-middle_00000087372448472840983920000011585739100693453957_"),y=document.getElementById("st-outer_00000149365794259480069290000012905892062090138803_");a.p8.to([h,v,y],{opacity:.5});const g=(new Map).set(0,{x:1330,y:306}).set(1,{x:1539,y:306}).set(2,{x:1748,y:306}).set(3,{x:1330,y:543}).set(4,{x:1539,y:543}).set(5,{x:1748,y:543}).set(6,{x:1330,y:774}).set(7,{x:1539,y:774}).set(8,{x:1748,y:774});let E=[],k=[];["chicken","catfish","dog","goat","goldfish","cow","parrot","cat"].forEach((e=>{const t=n().camelCase(`s-${e}`);if(!data.procedure[t])return console.warn(`${e} not found in data.procedure, treating it as unknown.`),void k.push(e);"yes"===data.procedure[t].response.split("-").at(-1)&&E.push(e),"no"===data.procedure[t].response.split("-").at(-1)&&k.push(e)})),E=[...E,"humanidj"];let x=n().shuffle(E);data.animalOrder&&(x=data.animalOrder.map((e=>e.slice(2).replaceAll("-",""))));const f=n().intersection(x,E);data.procedure.sTaskIdj.knownAnimals=E,data.procedure.sTaskIdj.unknownAnimals=k,data.procedure.sTaskIdj.knownAnimalOrder=f;const w=f.map((e=>document.getElementById(`link-stidj-${e}`))),B=k.map((e=>document.getElementById(`link-stidj-${e}`)));a.p8.set(B,{autoAlpha:0}),a.p8.set(w,{autoAlpha:.5}),a.p8.set([o,p],{autoAlpha:0,pointerEvents:"none"}),w.forEach(((e,t)=>{(0,c.PA)(e,g.get(t).x,g.get(t).y)}));const I=f.reduce(((e,t,o)=>(e[t]=o,e)),{});let A=!0;s.addEventListener("play",(()=>{A=!0})),l.addEventListener("play",(()=>{A=!0})),s.addEventListener("ended",(()=>{A=!1,a.p8.to(s,{autoAlpha:0})})),l.addEventListener("ended",(()=>{A=!1}));const j=document.getElementById("s-blocking-state");j.removeAttribute("visibility");const L=await fetch(`./cultures/${data.culture}/video/s-task.${data.meta.videoExtension}`),T=await L.blob(),$=URL.createObjectURL(T);for(j.setAttribute("visibility","hidden"),s.src=$;A;)await(0,c._v)(100);a.p8.to(w,{autoAlpha:1}),(0,d.hY)(`./cultures/${data.culture}/audio/s-task-cut.mp3`,p.id),a.p8.to(p,{autoAlpha:1,pointerEvents:"visible"});const b=h.getBBox().width/2,_=v.getBBox().width/2,M=y.getBBox().width/2,O=h.getBBox().x+b,Y=h.getBBox().y+b,P=r._.create(w,{onPress:function(){const e=this.target.id;let t=e.slice(11);console.log(e),console.log(t),(0,d.hY)(`./cultures/${data.culture}/audio/st-${t}.mp3`)},onDrag:function(){const e=this.target,t=e.getBBox(),o=e.getBBox().height/2,r=e.getBBox().width/2;let s=t.x+r+this.x,n=t.y+o+this.y;const d=Math.sqrt(Math.pow(s-O,2)+Math.pow(n-Y,2));1.2*d<=b+r&&(a.p8.to(h,{opacity:1}),a.p8.to([v,y],{opacity:.5})),1.2*d<=_+r&&1.2*d>b+r&&(a.p8.to(v,{opacity:1}),a.p8.to([h,y],{opacity:.5})),1.2*d<=M+r&&1.2*d>_+r&&(a.p8.to(y,{opacity:1}),a.p8.to([h,v],{opacity:.5}),a.p8.to(this.target,{scale:.5,transformOrigin:"50% 50%"})),1.2*d>M+r&&(a.p8.to(this.target,{scale:1,transformOrigin:"50% 50%"}),a.p8.to([h,v,y],{opacity:.5}))},onDragEnd:function(){const e=this.target,t=e.id;console.log(t);const o=t.slice(11),r=e.getBBox(),s=e.getBBox().height/2,n=e.getBBox().width/2,i=a.p8.getProperty(e,"x"),c=a.p8.getProperty(e,"y"),u=I[o];let l=r.x+n+this.x,p=r.y+s+this.y;const m=Math.sqrt(Math.pow(l-O,2)+Math.pow(p-Y,2));1.2*m<=b+n&&((0,d.hY)(`./cultures/${data.culture}/audio/inner.mp3`),data.procedure.sTaskIdj[o].circle="inner",data.procedure.sTaskIdj[o].coords.x=i,data.procedure.sTaskIdj[o].coords.y=c,a.p8.to(h,{opacity:.5,duration:.25})),1.2*m<=_+n&&1.2*m>b+n&&((0,d.hY)(`./cultures/${data.culture}/audio/middle.mp3`),data.procedure.sTaskIdj[o].circle="middle",data.procedure.sTaskIdj[o].coords.x=i,data.procedure.sTaskIdj[o].coords.y=c,a.p8.to(v,{opacity:.5,duration:.25})),1.2*m<=M+n&&1.2*m>_+n&&((0,d.hY)(`./cultures/${data.culture}/audio/outer.mp3`),data.procedure.sTaskIdj[o].circle="outer",data.procedure.sTaskIdj[o].coords.x=i,data.procedure.sTaskIdj[o].coords.y=c,a.p8.to(y,{opacity:.5,duration:.25})),1.2*m>M+n&&(void 0===data.procedure.sTaskIdj[o].circle?a.p8.to(e,{x:g.get(u).x,y:g.get(u).y}):a.p8.to(e,{x:data.procedure.sTaskIdj[o].coords.x,y:data.procedure.sTaskIdj[o].coords.y,scale:.5}))}}),C=()=>{let e=[];return E.forEach((t=>{data.procedure.sTaskIdj[t].circle||e.push(!1)})),e},q=()=>{let e=0;return E.forEach((t=>{data.procedure.sTaskIdj[t].circle&&e++})),e};for(;q()<Math.ceil(E.length/2);)await(0,c._v)(500);for(console.log("Comprehension check..."),a.p8.to([w,h,v,y],{opacity:.5}),P.forEach((e=>{e.disable()}));A;)await(0,c._v)(100);function D(){a.p8.timeline().to(h,{autoAlpha:1})}function R(){a.p8.timeline().to(h,{autoAlpha:.5})}function S(){a.p8.timeline().to(v,{autoAlpha:1})}function U(){a.p8.timeline().to(v,{autoAlpha:.5})}function H(){a.p8.timeline().to(y,{autoAlpha:1})}function z(){a.p8.timeline().to(y,{autoAlpha:.5})}for(const[e,t]of data.procedure.sTaskIdj.comprehension.order.entries()){a.p8.set(p,{opacity:.5,pointerEvents:"none"}),(0,d.hY)(`./cultures/${data.culture}/audio/s-comp-check-${t}.mp3`,p.id),0===e&&await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check.mp3`),await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check-${t}.mp3`),0===e&&await(0,d.bA)(`./cultures/${data.culture}/audio/s-comp-check-expl.mp3`),a.p8.set(p,{opacity:1,pointerEvents:"visible"}),m.style.cursor="pointer",h.addEventListener("mousemove",D),h.addEventListener("mouseenter",D),h.addEventListener("mouseleave",R),v.addEventListener("mousemove",S),v.addEventListener("mouseenter",S),v.addEventListener("mouseleave",U),y.addEventListener("mousemove",H),y.addEventListener("mouseenter",H),y.addEventListener("mouseleave",z);const o=await(0,i.c)(["st-inner_00000137851898872019742480000005807525445235371402_","st-middle_00000087372448472840983920000011585739100693453957_","st-outer_00000149365794259480069290000012905892062090138803_"]);m.style.cursor="default",h.removeEventListener("mousemove",D),h.removeEventListener("mouseenter",D),h.removeEventListener("mouseleave",R),v.removeEventListener("mousemove",S),v.removeEventListener("mouseenter",S),v.removeEventListener("mouseleave",U),y.removeEventListener("mousemove",H),y.removeEventListener("mouseenter",H),y.removeEventListener("mouseleave",z);const r=["ok","alright","okThanks"],s=r[Math.floor(Math.random()*r.length)];await(0,d.bA)(`./cultures/${data.culture}/audio/neutral-resp-${s}.mp3`),a.p8.to([h,v,y],{autoAlpha:.5}),o.id.slice(3)===t&&(data.procedure.sTaskIdj.comprehension[t]=!0)}for(data.procedure.sTaskIdj.comprehension.completed=!0,a.p8.to(w,{opacity:1}),P.forEach((e=>{e.enable()}));C().length>0;)await(0,c._v)(1e3);for(a.p8.to([w,h,v,y],{opacity:.5}),P.forEach((e=>{e.disable()})),A=!0,(0,d.hY)(`./cultures/${data.culture}/audio/sqr-next-red.mp3`),a.p8.timeline().to(o,{autoAlpha:.5}).to(o,{filter:"drop-shadow(0px 0px 14px #a90707)",delay:1,repeat:-1,yoyo:!0,reversed:!0});A;)await(0,c._v)(100);a.p8.to(o,{autoAlpha:1,pointerEvents:"visible"}),await(0,i.c)(o.id)}},7103:(e,t,o)=>{o.d(t,{c:()=>a});const a=e=>new Promise((t=>{const o=e=>{const o=e.target;return t(o)};"string"==typeof e&&document.getElementById(e).addEventListener("click",o,{once:!0}),Array.isArray(e)&&e.forEach((e=>{document.getElementById(e).addEventListener("click",o,{once:!0})})),void 0===e&&document.getElementById("wrapper").addEventListener("click",o,{once:!0})}))}}]);